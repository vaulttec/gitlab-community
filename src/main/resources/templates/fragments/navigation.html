<!DOCTYPE html>
<html lang="en" xmlns="http://www.w3.org/1999/xhtml"
	xmlns:th="https://www.thymeleaf.org"
	xmlns:sec="https://www.thymeleaf.org/thymeleaf-extras-springsecurity5">
<body>
	<div th:fragment="navigation">
		<nav class="navbar navbar-expand-sm navbar-dark bg-dark fixed-top">
			<a class="navbar-brand"
				th:href="${@environment.getProperty('gitlab.server-url')}"> <img
				th:src="@{/img/gitlab-icon.png}" width="30" height="30"
				alt="GitLab logo">
			</a>

			<button class="navbar-toggler" type="button" data-toggle="collapse"
				data-target="#navbarCollapse">
				<span class="navbar-toggler-icon"></span>
			</button>

			<div class="collapse navbar-collapse" id="navbarCollapse">
				<div class="navbar-nav">
					<a class="nav-item nav-link" th:href="@{/topics}">Topics</a> <a
						class="nav-item nav-link" th:href="@{/members}">Members</a>
				</div>

				<div class="navbar-nav ml-auto">
					<div class="nav-item dropdown"
						sec:authorize="hasRole('ROLE_ADMIN')">
						<a class="nav-link dropdown-toggle" href="#"
							data-toggle="dropdown"><i class="fa fa-cog"></i></a>
						<div class="dropdown-menu dropdown-menu-right">
							<a class="dropdown-item" th:href="@{/topics/new}"><i
								class="fa fa-plus-circle"></i> Create new topic</a>
						  <a class="dropdown-item" th:if="${create == null && topic != null && topic.path != null}"
								th:href="@{/topics/{path}/edit(path=${topic.path})}">
								<i class="fa fa-pencil-square-o"></i>
								Edit current topic</a>
						</div>
					</div>

					<div class="nav-item dropdown">
						<a class="nav-link dropdown-toggle" href="#"
							data-toggle="dropdown"> <img
							th:if="${#authentication.authorities[0].userInfo.claims['picture']}"
							class="rounded-circle"
							th:src="${#authentication.authorities[0].userInfo.claims['picture']}"
							width="30" height="30" alt="avatar" /> <img
							th:unless="${#authentication.authorities[0].userInfo.claims['picture']}"
							class="rounded-circle" th:src="@{/img/no-avatar.png}" width="30"
							height="30" alt="avatar" />
						</a>
						<form class="form-inline" th:action="@{/logout}" method="post">
							<ul class="dropdown-menu dropdown-menu-right">
								<li><a class="dropdown-item"
									th:unless="${#authorization.expression('hasRole(''ROLE_GUEST'')')}"
									th:href="@{/members/{name}(name=${#authentication.name})}"><i
										class="fa fa-user-o"></i> Profile</a></li>
								<li class="divider dropdown-divider"></li>
								<li><button class="dropdown-item btn" type="submit">
										<i class="fa fa-power-off"></i> Logout
									</button></li>
							</ul>
						</form>
					</div>
				</div>
			</div>
		</nav>
	</div>
</body>
</html>
